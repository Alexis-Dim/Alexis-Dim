<svg width="100%" height="350" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 800 350">

    <defs>
        <!-- 
          STYLE BLOCK FOR THEME DETECTION:
          - Defines a CSS variable (--grid-bg-color) for the grid background.
          - Default color is for light mode.
          - The @media query overrides the color for users in dark mode.
        -->
        <style>
            :root {
                --grid-bg-color: #ebedf0; /* Test color for LIGHT mode */
            }
            @media (prefers-color-scheme: dark) {
                :root {
                    --grid-bg-color: #151b23; /* Correct color for DARK mode */
                }
            }
        </style>
        
        <!-- Define a pattern for the grid using the theme-aware color -->
        <pattern id="grid" width="13" height="13" patternUnits="userSpaceOnUse">
            <rect x="1.5" y="1.5" width="10" height="10" fill="var(--grid-bg-color)" rx="2" ry="2"/>
        </pattern>

        <!-- Define Spaceship SVG content with light grey color -->
        <g id="spaceship" transform="translate(0.000000,32.000000) scale(0.120000,-0.120000)">
            <path d="M151 280 c0 -20 -6 -41 -13 -48 -7 -7 -9 -12 -5 -12 4 0 1 -15 -7 -34 -8 -19 -12 -37 -10 -40 2 -3 1 -4 -2 -1 -4 2 -24 -5 -45 -16 l-39 -19 -2 37 -1 38 -4 -35 c-3 -19 -9 -39 -14 -44 -14 -15 -11 -29 6 -22 19 7 77 -12 92 -31 6 -8 9 -21 6 -29 -3 -9 2 -14 16 -14 25 0 26 7 4 32 -14 16 -14 18 0 18 8 0 18 8 20 18 4 16 5 16 6 0 0 -10 8 -18 18 -18 15 0 15 -1 0 -18 -22 -25 -21 -32 4 -32 14 0 19 5 16 14 -3 8 0 21 6 29 15 19 73 38 92 31 17 -7 20 7 6 22 -5 5 -11 25 -14 44 l-4 35 -1 -38 -2 -37 -39 19 c-21 11 -41 18 -45 16 -3 -3 -4 -2 -2 1 2 3 -2 21 -10 40 -8 19 -14 35 -13 36 0 2 -2 10 -5 18 -3 8 -7 29 -9 45 -4 28 -4 28 -6 -5z m12 -127 c-3 -15 -1 -23 7 -23 10 0 10 -3 0 -15 -10 -12 -16 -13 -27 -4 -10 9 -11 14 -2 20 7 4 9 14 6 23 -4 9 -4 23 0 32 9 24 24 -5 16 -33z m-40 -63 c7 -29 1 -24 -17 11 -12 23 -12 28 -2 20 8 -7 16 -21 19 -31z m81 10 c-17 -33 -27 -40 -17 -12 6 17 23 42 28 42 2 0 -3 -13 -11 -30z" fill="#D3D3D3"/>
        </g>

        <!-- Gradient for explosion effect -->
        <radialGradient id="explosionGradient" cx="50%" cy="50%" r="60%" fx="50%" fy="50%">
            <stop offset="0%" stop-color="white" stop-opacity="1"/>
            <stop offset="30%" stop-color="yellow" stop-opacity="1"/>
            <stop offset="60%" stop-color="orange" stop-opacity="0.8"/>
            <stop offset="100%" stop-color="red" stop-opacity="0.6"/>
        </radialGradient>

        <filter id="explosionFilter" x="-50%" y="-50%" width="200%" height="200%">
            <feGaussianBlur in="SourceGraphic" stdDeviation="5"/>
        </filter>

        <filter id="soundWaveFilter" x="-50%" y="-50%" width="200%" height="200%">
            <feGaussianBlur in="SourceGraphic" stdDeviation="4"/>
        </filter>
    </defs>

    <!-- Background grid container -->
    <rect width="689" height="91" fill="url(#grid)" x="56" y="12"/>

    <!-- 
      GREEN BOXES WITH CORRECTED POSITIONS:
      - The x and y values have been recalculated to align with the grid cells.
      - The formula used is roughly:
        x = 57.5 + (column_index * 13)
        y = 13.5 + (row_index * 13)
    -->
    <rect x="70.5" y="26.5" width="10" height="10" fill="#39d353" rx="2" ry="2">
        <animate attributeName="opacity" values="1;1;0;0;1" keyTimes="0;0.03;0.035;0.98;1" dur="15s" begin="0s" repeatCount="indefinite"/>
    </rect>
    <rect x="109.5" y="40.5" width="10" height="10" fill="#39d353" rx="2" ry="2">
        <animate attributeName="opacity" values="1;1;0;0;1" keyTimes="0;0.07;0.075;0.98;1" dur="15s" begin="0s" repeatCount="indefinite"/>
    </rect>
    <rect x="148.5" y="79.5" width="10" height="10" fill="#39d353" rx="2" ry="2">
        <animate attributeName="opacity" values="1;1;0;0;1" keyTimes="0;0.1;0.105;0.98;1" dur="15s" begin="0s" repeatCount="indefinite"/>
    </rect>
    <rect x="187.5" y="40.5" width="10" height="10" fill="#39d353" rx="2" ry="2">
        <animate attributeName="opacity" values="1;1;0;0;1" keyTimes="0;0.14;0.145;0.97;1" dur="15s" begin="0s" repeatCount="indefinite"/>
    </rect>
    <rect x="213.5" y="40.5" width="10" height="10" fill="#39d353" rx="2" ry="2">
        <animate attributeName="opacity" values="1;1;0;0;1" keyTimes="0;0.18;0.185;0.97;1" dur="15s" begin="0s" repeatCount="indefinite"/>
    </rect>
    <rect x="265.5" y="26.5" width="10" height="10" fill="#39d353" rx="2" ry="2">
        <animate attributeName="opacity" values="1;1;0;0;1" keyTimes="0;0.22;0.225;0.96;1" dur="15s" begin="0s" repeatCount="indefinite"/>
    </rect>
    <rect x="317.5" y="79.5" width="10" height="10" fill="#39d353" rx="2" ry="2">
        <animate attributeName="opacity" values="1;1;0;0;1" keyTimes="0;0.25;0.255;0.96;1" dur="15s" begin="0s" repeatCount="indefinite"/>
    </rect>
    <rect x="382.5" y="53.5" width="10" height="10" fill="#39d353" rx="2" ry="2">
        <animate attributeName="opacity" values="1;1;0;0;1" keyTimes="0;0.28;0.285;0.95;1" dur="15s" begin="0s" repeatCount="indefinite"/>
    </rect>
    <rect x="421.5" y="40.5" width="10" height="10" fill="#39d353" rx="2" ry="2">
        <animate attributeName="opacity" values="1;1;0;0;1" keyTimes="0;0.31;0.315;0.95;1" dur="15s" begin="0s" repeatCount="indefinite"/>
    </rect>
    <rect x="460.5" y="66.5" width="10" height="10" fill="#39d353" rx="2" ry="2">
        <animate attributeName="opacity" values="1;1;0;0;1" keyTimes="0;0.34;0.345;0.94;1" dur="15s" begin="0s" repeatCount="indefinite"/>
    </rect>
    <rect x="512.5" y="53.5" width="10" height="10" fill="#39d353" rx="2" ry="2">
        <animate attributeName="opacity" values="1;1;0;0;1" keyTimes="0;0.37;0.375;0.94;1" dur="15s" begin="0s" repeatCount="indefinite"/>
    </rect>
    <rect x="577.5" y="26.5" width="10" height="10" fill="#39d353" rx="2" ry="2">
        <animate attributeName="opacity" values="1;1;0;0;1" keyTimes="0;0.41;0.415;0.93;1" dur="15s" begin="0s" repeatCount="indefinite"/>
    </rect>
    <rect x="629.5" y="53.5" width="10" height="10" fill="#39d353" rx="2" ry="2">
        <animate attributeName="opacity" values="1;1;0;0;1" keyTimes="0;0.44;0.445;0.93;1" dur="15s" begin="0s" repeatCount="indefinite"/>
    </rect>
    <!-- Extra Boxes -->
    <rect x="291.5" y="92.5" width="10" height="10" fill="#39d353" rx="2" ry="2">
        <animate attributeName="opacity" values="1;1;0;0;1" keyTimes="0;0.47;0.475;0.92;1" dur="15s" begin="0s" repeatCount="indefinite"/>
    </rect>
    <rect x="603.5" y="66.5" width="10" height="10" fill="#39d353" rx="2" ry="2">
        <animate attributeName="opacity" values="1;1;0;0;1" keyTimes="0;0.5;0.505;0.92;1" dur="15s" begin="0s" repeatCount="indefinite"/>
    </rect>

    <!-- Spaceship and motion path -->
    <use xlink:href="#spaceship" x="-50" y="200"/>
    <path id="path" d="M 100 50 A 25 20 0 0 1 300 50 A 70 20 0 0 0 550 50 A 70 20 0 0 1 780 50 A 70 20 0 1 1 550 50 A 25 20 0 1 0 300 50 A 70 20 0 1 1 100 50" fill="none" stroke="none"/>
    <animateMotion xlink:href="#spaceship" dur="15s" repeatCount="indefinite">
        <mpath xlink:href="#path"/>
    </animateMotion>

    <!-- Explosion effects (positions centered on the green boxes) -->
    <circle id="explosion1" cx="75.5" cy="31.5" r="0" fill="url(#explosionGradient)" filter="url(#explosionFilter)"/>
    <animate xlink:href="#explosion1" attributeName="r" values="0;40;0" keyTimes="0;0.1;1" dur="0.5s" begin="0.5s" repeatCount="indefinite"/>
    <animate xlink:href="#explosion1" attributeName="opacity" values="1;0" keyTimes="0;1" dur="0.5s" begin="0.5s" repeatCount="indefinite"/>

    <circle id="explosion2" cx="114.5" cy="45.5" r="0" fill="url(#explosionGradient)" filter="url(#explosionFilter)"/>
    <animate xlink:href="#explosion2" attributeName="r" values="0;40;0" keyTimes="0;0.1;1" dur="0.5s" begin="1.05s" repeatCount="indefinite"/>
    <animate xlink:href="#explosion2" attributeName="opacity" values="1;0" keyTimes="0;1" dur="0.5s" begin="1.05s" repeatCount="indefinite"/>

    <circle id="explosion3" cx="153.5" cy="84.5" r="0" fill="url(#explosionGradient)" filter="url(#explosionFilter)"/>
    <animate xlink:href="#explosion3" attributeName="r" values="0;40;0" keyTimes="0;0.1;1" dur="0.5s" begin="1.5s" repeatCount="indefinite"/>
    <animate xlink:href="#explosion3" attributeName="opacity" values="1;0" keyTimes="0;1" dur="0.5s" begin="1.5s" repeatCount="indefinite"/>

    <circle id="explosion4" cx="192.5" cy="45.5" r="0" fill="url(#explosionGradient)" filter="url(#explosionFilter)"/>
    <animate xlink:href="#explosion4" attributeName="r" values="0;40;0" keyTimes="0;0.1;1" dur="0.5s" begin="2.1s" repeatCount="indefinite"/>
    <animate xlink:href="#explosion4" attributeName="opacity" values="1;0" keyTimes="0;1" dur="0.5s" begin="2.1s" repeatCount="indefinite"/>

    <circle id="explosion5" cx="218.5" cy="45.5" r="0" fill="url(#explosionGradient)" filter="url(#explosionFilter)"/>
    <animate xlink:href="#explosion5" attributeName="r" values="0;40;0" keyTimes="0;0.1;1" dur="0.5s" begin="2.7s" repeatCount="indefinite"/>
    <animate xlink:href="#explosion5" attributeName="opacity" values="1;0" keyTimes="0;1" dur="0.5s" begin="2.7s" repeatCount="indefinite"/>

    <circle id="explosion6" cx="270.5" cy="31.5" r="0" fill="url(#explosionGradient)" filter="url(#explosionFilter)"/>
    <animate xlink:href="#explosion6" attributeName="r" values="0;40;0" keyTimes="0;0.1;1" dur="0.5s" begin="3.3s" repeatCount="indefinite"/>
    <animate xlink:href="#explosion6" attributeName="opacity" values="1;0" keyTimes="0;1" dur="0.5s" begin="3.3s" repeatCount="indefinite"/>

    <circle id="explosion7" cx="322.5" cy="84.5" r="0" fill="url(#explosionGradient)" filter="url(#explosionFilter)"/>
    <animate xlink:href="#explosion7" attributeName="r" values="0;40;0" keyTimes="0;0.1;1" dur="0.5s" begin="3.75s" repeatCount="indefinite"/>
    <animate xlink:href="#explosion7" attributeName="opacity" values="1;0" keyTimes="0;1" dur="0.5s" begin="3.75s" repeatCount="indefinite"/>

    <circle id="explosion8" cx="387.5" cy="58.5" r="0" fill="url(#explosionGradient)" filter="url(#explosionFilter)"/>
    <animate xlink:href="#explosion8" attributeName="r" values="0;40;0" keyTimes="0;0.1;1" dur="0.5s" begin="4.2s" repeatCount="indefinite"/>
    <animate xlink:href="#explosion8" attributeName="opacity" values="1;0" keyTimes="0;1" dur="0.5s" begin="4.2s" repeatCount="indefinite"/>

    <circle id="explosion9" cx="426.5" cy="45.5" r="0" fill="url(#explosionGradient)" filter="url(#explosionFilter)"/>
    <animate xlink:href="#explosion9" attributeName="r" values="0;40;0" keyTimes="0;0.1;1" dur="0.5s" begin="4.65s" repeatCount="indefinite"/>
    <animate xlink:href="#explosion9" attributeName="opacity" values="1;0" keyTimes="0;1" dur="0.5s" begin="4.65s" repeatCount="indefinite"/>

    <circle id="explosion10" cx="465.5" cy="71.5" r="0" fill="url(#explosionGradient)" filter="url(#explosionFilter)"/>
    <animate xlink:href="#explosion10" attributeName="r" values="0;40;0" keyTimes="0;0.1;1" dur="0.5s" begin="5.1s" repeatCount="indefinite"/>
    <animate xlink:href="#explosion10" attributeName="opacity" values="1;0" keyTimes="0;1" dur="0.5s" begin="5.1s" repeatCount="indefinite"/>

    <circle id="explosion11" cx="517.5" cy="58.5" r="0" fill="url(#explosionGradient)" filter="url(#explosionFilter)"/>
    <animate xlink:href="#explosion11" attributeName="r" values="0;40;0" keyTimes="0;0.1;1" dur="0.5s" begin="5.55s" repeatCount="indefinite"/>
    <animate xlink:href="#explosion11" attributeName="opacity" values="1;0" keyTimes="0;1" dur="0.5s" begin="5.55s" repeatCount="indefinite"/>

    <circle id="explosion12" cx="582.5" cy="31.5" r="0" fill="url(#explosionGradient)" filter="url(#explosionFilter)"/>
    <animate xlink:href="#explosion12" attributeName="r" values="0;40;0" keyTimes="0;0.1;1" dur="0.5s" begin="6.15s" repeatCount="indefinite"/>
    <animate xlink:href="#explosion12" attributeName="opacity" values="1;0" keyTimes="0;1" dur="0.5s" begin="6.15s" repeatCount="indefinite"/>

    <circle id="explosion13" cx="634.5" cy="58.5" r="0" fill="url(#explosionGradient)" filter="url(#explosionFilter)"/>
    <animate xlink:href="#explosion13" attributeName="r" values="0;40;0" keyTimes="0;0.1;1" dur="0.5s" begin="6.6s" repeatCount="indefinite"/>
    <animate xlink:href="#explosion13" attributeName="opacity" values="1;0" keyTimes="0;1" dur="0.5s" begin="6.6s" repeatCount="indefinite"/>
    
    <!-- Explosions for Extra Boxes -->
    <circle id="explosion14" cx="296.5" cy="97.5" r="0" fill="url(#explosionGradient)" filter="url(#explosionFilter)"/>
    <animate xlink:href="#explosion14" attributeName="r" values="0;40;0" keyTimes="0;0.1;1" dur="0.5s" begin="7.05s" repeatCount="indefinite"/>
    <animate xlink:href="#explosion14" attributeName="opacity" values="1;0" keyTimes="0;1" dur="0.5s" begin="7.05s" repeatCount="indefinite"/>

    <circle id="explosion15" cx="608.5" cy="71.5" r="0" fill="url(#explosionGradient)" filter="url(#explosionFilter)"/>
    <animate xlink:href="#explosion15" attributeName="r" values="0;40;0" keyTimes="0;0.1;1" dur="0.5s" begin="7.5s" repeatCount="indefinite"/>
    <animate xlink:href="#explosion15" attributeName="opacity" values="1;0" keyTimes="0;1" dur="0.5s" begin="7.5s" repeatCount="indefinite"/>


    <!-- Sound Waves (centered on explosions) -->
    <circle cx="153.5" cy="84.5" r="0" stroke="white" stroke-width="2" fill="none" filter="url(#soundWaveFilter)">
        <animate attributeName="r" values="0;100;0" keyTimes="0;0.5;1" dur="1s" begin="1.5s" repeatCount="indefinite"/>
        <animate attributeName="stroke-opacity" values="1;0;0" keyTimes="0;0.5;1" dur="1s" begin="1.5s" repeatCount="indefinite"/>
    </circle>
    <circle cx="387.5" cy="58.5" r="0" stroke="white" stroke-width="2" fill="none" filter="url(#soundWaveFilter)">
        <animate attributeName="r" values="0;100;0" keyTimes="0;0.5;1" dur="1s" begin="4.2s" repeatCount="indefinite"/>
        <animate attributeName="stroke-opacity" values="1;0;0" keyTimes="0;0.5;1" dur="1s" begin="4.2s" repeatCount="indefinite"/>
    </circle>
    <circle cx="582.5" cy="31.5" r="0" stroke="white" stroke-width="2" fill="none" filter="url(#soundWaveFilter)">
        <animate attributeName="r" values="0;120;0" keyTimes="0;0.5;1" dur="1.2s" begin="6.15s" repeatCount="indefinite"/>
        <animate attributeName="stroke-opacity" values="1;0;0" keyTimes="0;0.5;1" dur="1.2s" begin="6.15s" repeatCount="indefinite"/>
    </circle>
</svg>
